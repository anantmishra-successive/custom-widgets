/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import e from"./3RODMSQG.js";import{b as M}from"./EHA2DPVG.js";import c from"./NCOEWMF7.js";import b from"./5NI5R3AO.js";import{a as X}from"./QDODWAYJ.js";import"./ITSRCSFZ.js";import a from"./PDDPZQ7S.js";import{A as p,E as V,c as B,d as v,n as T,z as $}from"./MDSKC43G.js";import{h as y,j as Y,l as m,m as d,o as x,p as S,s as h}from"./P76SCC25.js";import{f as i,g as r,i as R}from"./TJWJSZZ6.js";import"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{c:D,h:g,i:N,j:w,k:G,r:P,s:C,w:a,y:O,z:u},{e:j},{a:_,b:E,c:W},{d:b,f:l}])=>{var L={type:g.TS,color:[1,1,1,255],font:{family:"Tahoma",size:12,decoration:G.None,style:N.Normal,weight:w.Normal}},k={type:g.SLS,color:[1,1,1,255],style:D.Solid,width:2},f={element:"chart-element",elementList:"element-list",sectionLabel:"section-label"},z=B`:host{width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}.section-label{display:flex;margin:var(--arcgis-charts-config-margin-major) var(--arcgis-charts-config-margin-minor);justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}.element-list{margin:var(--arcgis-charts-config-margin-minor)}.element{user-select:none}`,F=class extends ${constructor(){super(...arguments),this._messages=X(),this.formatPopover=null,this.selectableElements=[],this.textProperties=[],this.symbolProperties=[],this.symbolPropertyChange=t=>{let e=t,s;if(e.target?.localName==="calcite-list-item"?s=e.target?.value:s=e.target?.parentNode?.value,this.selectedTexts=[],this.selectedBackground=[],this.selectedSymbols.includes(s))this.selectedSymbols=[],this.updateSelectedElement(this.selectedSymbols);else{let o=this.getFormatValue(s);this.selectedSymbols=[s],this.initSelectedSymbols(b(o)?o:k)}this.setupFormatPopover()},this.textPropertyChange=t=>{let e=t,s;if(e.target?.localName==="calcite-list-item"?s=e.target?.value:s=e.target?.parentNode?.value,this.selectedSymbols=[],this.selectedBackground=[],e.shiftKey){this.selectedTexts=[];let o=this.textProperties.indexOf(this.lastSelectedText??s),n=this.textProperties.indexOf(s);this.textProperties.forEach((c,A)=>{A>=Math.min(o,n)&&A<=Math.max(o,n)&&this.selectedTexts.push(c)}),this.updateSelectedElement(this.selectedTexts),this.setupFormatPopover()}else if(e.ctrlKey)this.selectedTexts.includes(s)?(this.selectedTexts=this.selectedTexts.filter(o=>o!==s),this.updateSelectedElement(this.selectedTexts)):(this.selectedTexts=[...this.selectedTexts,s],this.updateSelectedElement(this.selectedTexts)),this.setupFormatPopover();else if(this.selectedTexts.includes(s))this.selectedTexts=[],this.updateSelectedElement(this.selectedTexts),this.setupFormatPopover();else{let o=this.getFormatValue(s);this.selectedTexts=[s],this.initSelectedTexts(l(o)?o:L),this.setupFormatPopover()}this.lastSelectedText=s},this.backgroundChange=t=>{let e=t,s;e.target?.localName==="calcite-list-item"?s=e.target?.value:s=e.target?.parentNode?.value,this.selectedSymbols=[],this.selectedTexts=[],this.selectedBackground.includes(s)?(this.selectedBackground=[],this.selectedElement={}):(this.selectedBackground=[s],this.selectedElement=u(this.getFormatValue(s))?void 0:this.getFormatValue(s)),this.setupFormatPopover()},this.updateSymbolProps=t=>{let e=t.detail;this.selectedSymbols.forEach(s=>{this.setFormatValue(s,e)}),this.selectedElement=a(t.target.selectedElement)},this.updateBackground=t=>{this.setFormatValue(R.Background,t.detail),this.selectedElement=t.detail},this.updateTextProps=t=>{let{font:e,color:s}=t.detail;this.selectedTexts.forEach(o=>{let n=this.getFormatValue(o),c=l(n)?n:void 0;this.setFormatValue(o,{...c,type:g.TS,font:{...c?.font,...e},color:s??c?.color})}),this.selectedElement=a(t.target.selectedElement)},this.onModelConfigChange=()=>{this.requestUpdate()},this.formatPopoverClose=t=>{this.formatPopover===t?.target&&(this.selectedTexts=[],this.selectedSymbols=[],this.selectedBackground=[],this.selectedElement={},this.removeFormatPopover())},this.mergeFormatValues=(t,e)=>{let s=!1;P(t)&&P(e)||C(t)&&C(e)?s=!0:s=t===e;let o=typeof t=="number"||typeof e=="number"?Number.NaN:"";return s?void 0:o},this.openChange=t=>{this.arcgisChartsConfigPopoverOpenChange.emit(t.detail)},this.updateSelectableElements=t=>{t&&!this.selectableElements.includes(t)&&this.selectableElements.push(t)},this.selectedSymbols=[],this.selectedTexts=[],this.selectedBackground=[],this.arcgisChartsConfigFormatPopoverChange=T(),this.arcgisChartsConfigPopoverOpenChange=T()}static{this.properties={selectedSymbols:16,selectedTexts:16,selectedBackground:16,selectedElement:16,messageOverrides:0,model:0}}static{this.styles=z}load(){this.modelChange(this.model)}willUpdate(t){t.has("model")&&this.modelChange(this.model,t.get("model"))}disconnectedCallback(){super.disconnectedCallback(),this.removeFormatPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(t,e){e?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),t?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}correctTextElementSelection(){for(let t of this.selectableElements){let e=this.selectedTexts.includes(t.value)||this.selectedSymbols.includes(t.value)||this.selectedBackground.includes(t.value);t.selected=e}}formatPopoverChange(t){this.arcgisChartsConfigFormatPopoverChange.emit({open:t,element:this.formatPopover}),this.arcgisChartsConfigPopoverOpenChange.emit({open:t})}updateSelectedElement(t,e){if(this.selectedElement=void 0,e===void 0){let s=a(this.getFormatValue(t[0]));this.selectedElement=t?.reduce((o,n)=>{let c=this.getFormatValue(n);return O(o,c,this.mergeFormatValues)},s)}else{let s=a(e);u(e)&&(this.selectedSymbols?.length>0&&(s=a(k)),this.selectedTexts?.length>0&&(s=a(L))),this.selectedElement=s}}initSelectedTexts(t){let e=a(t);u(t)&&(e=a(L)),this.selectedElement=e}initSelectedSymbols(t){let e=a(t);u(t)&&(e=a(k)),this.selectedElement=e}setupFormatPopover(){this.formatPopover=E(this.formatPopover);let t=this.selectedElement,e={selectedElement:this.selectedElement,referenceElement:this.el,updateSymbolProps:this.updateSymbolProps,updateTextProps:this.updateTextProps,updateBackground:this.updateBackground,openChange:this.openChange,hostElement:this.el,placement:"auto",popoverClose:this.formatPopoverClose};this.formatPopover=W(_.FormatPopover,e),t?.type===g.TS||t?.type===g.SLS||Array.isArray(this.selectedElement)?(this.formatPopover.open=!0,this.addFormatPopover()):(this.formatPopover.open=!1,this.removeFormatPopover())}removeFormatPopover(){this.formatPopover!==null&&(this.formatPopover.open=!1,this.formatPopover=E(this.formatPopover)),this.formatPopoverChange(!1)}addFormatPopover(){this.formatPopover!==null&&!document.body.contains(this.formatPopover)&&document.body.appendChild(this.formatPopover),this.formatPopoverChange(!0)}getFormatValue(t){switch(t){case i.Title:return this.model.getTitleSymbol();case i.Description:return this.model.getDescriptionSymbol();case i.XAxisTitle:return m(this.model)?this.model.getXAxisTitleSymbol():void 0;case i.YAxisTitle:return d(this.model)?this.model.getYAxisTitleSymbol():void 0;case i.AxisLabels:return m(this.model)?this.model.getAxisLabelsSymbol():void 0;case i.GuideLabels:return S(this.model)?this.model.getGuideLabelsSymbol():void 0;case i.LegendText:return h(this.model)?this.model.getLegendTextSymbol():void 0;case i.LegendTitle:return h(this.model)?this.model.getLegendTitleSymbol():void 0;case i.DataLabels:return x(this.model)?this.model.getDataLabelsSymbol():void 0;case r.AxisLines:return m(this.model)?this.model.getAxisLinesSymbol():void 0;case r.GridLines:return d(this.model)?this.model.getGridLinesSymbol():void 0;case r.LeaderLines:return y(this.model)?this.model.getTicksSymbol():void 0;case i.Background:return this.model.getBackgroundColor();default:return}}setFormatValue(t,e){switch(t){case i.Title:l(e)&&this.model.setTitleSymbol(e);break;case i.Description:l(e)&&this.model.setDescriptionSymbol(e);break;case i.XAxisTitle:m(this.model)&&l(e)&&this.model.setXAxisTitleSymbol(e);break;case i.YAxisTitle:d(this.model)&&l(e)&&this.model.setYAxisTitleSymbol(e);break;case i.AxisLabels:m(this.model)&&l(e)&&this.model.setAxisLabelsSymbol(e);break;case i.GuideLabels:S(this.model)&&l(e)&&this.model.setGuideLabelsSymbol(e);break;case i.LegendText:h(this.model)&&l(e)&&this.model.setLegendTextSymbol(e);break;case i.LegendTitle:h(this.model)&&l(e)&&this.model.setLegendTitleSymbol(e);break;case i.DataLabels:x(this.model)&&l(e)&&this.model.setDataLabelsSymbol(e);break;case r.AxisLines:m(this.model)&&b(e)&&this.model.setAxisLinesSymbol(e);break;case r.GridLines:d(this.model)&&b(e)&&this.model.setGridLinesSymbol(e);break;case r.LeaderLines:y(this.model)&&b(e)&&this.model.setTicksSymbol(e);break;case i.Background:Array.isArray(e)&&this.model.setBackgroundColor(e);break}}renderFormatElements(){this.textProperties=[i.Title,...m(this.model)?[i.XAxisTitle]:[],...d(this.model)?[i.YAxisTitle]:[],...h(this.model)?[i.LegendTitle]:[],i.Description,...h(this.model)?[i.LegendText]:[],...m(this.model)?[i.AxisLabels]:[],...S(this.model)?[i.GuideLabels]:[],...x(this.model)?[i.DataLabels]:[]],Y(this.model)&&(this.textProperties=this.textProperties.filter(s=>s!==i.DataLabels)),this.symbolProperties=[i.Background,...m(this.model)?[r.AxisLines]:[],...d(this.model)?[r.GridLines]:[],...y(this.model)?[r.LeaderLines]:[]];let t=this.textProperties.map(s=>this.renderTextElement(s,this.textPropertyChange)),e=this.symbolProperties.map(s=>s===i.Background?this.renderTextElement(s,this.backgroundChange):this.renderTextElement(s,this.symbolPropertyChange));return{textElements:t,symbolElements:e}}renderTextElement(t,e){let s=j(t),o=this.getFormatValue(t),n=typeof o=="string"?o:"",c=this.selectedTexts.includes(t)||this.selectedSymbols.includes(t)||this.selectedBackground.includes(t);return v`<calcite-list-item class=${p(f.element)} .label=${this._messages[t]} .description=${n} .value=${t} .selected=${c} @click=${e} ${M(this.updateSelectableElements)}>${s!==void 0?v`<calcite-icon slot=content-start scale=s .icon=${s}></calcite-icon>`:null}</calcite-list-item>`}render(){let{textElements:t,symbolElements:e}=this.renderFormatElements();return v`<div class=${p(f.sectionLabel)}>${this._messages.textElements}</div><calcite-list label class=${p(f.elementList)} selection-mode=multiple selection-appearance=border @calciteListChange=${this.correctTextElementSelection}>${t}</calcite-list><div class=${p(f.sectionLabel)}>${this._messages.symbolElements}</div><calcite-list label class=${p(f.elementList)} selection-mode=single selection-appearance=border>${e}</calcite-list>`}};V("arcgis-charts-config-format",F);return F},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,c,e)
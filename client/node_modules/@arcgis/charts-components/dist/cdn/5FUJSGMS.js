/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import c from"./UHUEI4NU.js";import b from"./3RODMSQG.js";import a from"./PDDPZQ7S.js";import{b as d}from"./TJWJSZZ6.js";import{a as m,h,w as f}from"./IYCX42AE.js";export default $arcgis.t(([,,,,,,,{A:ie,Ga:re,Ka:R,Nb:O,Nc:te,Pc:G,Q:M,Qc:H,Rb:ae,b:Y,bc:le,fa:W,ha:S,ib:_,qa:J,ra:se,sa:oe,tb:F,u:N,w:$,ya:T,z:ee,za:j},{h:C,n:ne},{F:de,J:me,a:q,b:I,e:D,g:P,l:ce,m:ye}])=>{var _e=(i,e)=>e?.series?.[i]?.name,Ge=(i,e,s)=>{let o=s;o?.series?.[e]!==void 0&&(o.series[e].name=i)},He=(i,e)=>{let s,o=e.series?.[i];return o?.type===m.BoxPlotSeries?s=o.fillSymbol?.color:o?.type===m.LineSeries&&(s=o.lineSymbol?.color),s},xe=i=>{let e=i.series[0];return i.showMean===!0&&C(e)?e.fillSymbol?.color:void 0},Fe=(i,e)=>{let s=e.series[0];e.showMean===!0&&C(s)&&(s.fillSymbol!==void 0?s.fillSymbol.color=i:s.fillSymbol={...T(),color:i})},Ke=(i,e,s)=>{let o=s?.series?.[e];o?.type===m.BoxPlotSeries&&o.fillSymbol!==void 0?o.fillSymbol.color=i:o?.type===m.LineSeries&&o.lineSymbol!==void 0&&(o.lineSymbol.color=i,o.markerSymbol!==void 0&&(o.markerSymbol.color=i))},ve=i=>i.series.map(e=>e.id),Ie=(i,e)=>{e?.series?.sort((s,o)=>i.findIndex(r=>s.id===r)-i.findIndex(r=>o.id===r))},Qe=(i,e,s)=>{let o=ve(s),[r]=o.splice(i,1);o.splice(e,0,r),Ie(o,s)},Ue=i=>K(i)?i.series.findIndex(e=>e.type===m.BoxPlotSeries):-1,B=i=>O(i)?.x??S,Q=N(i=>{let e=O(i),s=e?.query?.where?.split("=")[0].trim()??"";return ae(e?.query?.where)?"":s},i=>O(i)?.query?.where),z=N(i=>le(i?.series).filter(e=>e!==""),i=>i?.series),V=async i=>{let{category:e,seriesIndex:s,y:o}=i,r={...await R(s),x:e===void 0||e===""?S:e,y:o,query:{}};return $(r)},Be=async i=>{let{category:e,seriesIndex:s,y:o}=i,r={...await re({seriesIndex:s}),x:e===void 0||e===""?S:e,y:o,query:{}};return $(r)};async function fe(i){let{x:e,y:s,seriesTemplate:o}=i,{id:r,fillSymbol:a}=o??{},l=await R(),n=r??`series_${Date.now()}`;return l.id=n,l.name=n,l.x=e,l.y=s,a?l.fillSymbol=a:l.fillSymbol&&(l.fillSymbol.color=_,l.fillSymbol?.outline&&(l.fillSymbol.outline.color=_)),l}async function ue(i){let{numericFields:e,config:s,layerInfo:o,category:r}=i,{layerFieldsInfo:a}=o,l=[],n=r??B(s),t=!1;if(e.length===0){let c=await V({y:"",seriesIndex:0,category:n});l.push(c)}else if(n===S){let c=await q(),y=e.length>1?e:e[0],A=await V({y,seriesIndex:0,category:n}),w=e.length>1?c.axisLabels.values:F(o.layerFieldsInfo,e[0]),g={...A,id:e[0],name:w,x:n},p=s.series.find(u=>ie(y,u.y)&&u.query?.where===void 0);p!==void 0&&(!s.colorMatch&&"fillSymbol"in p&&(g.fillSymbol=p.fillSymbol,t=!0),g.id=p.id,g.name=p.name),l.push(g)}else for(let c=0;c<e.length;c+=1){let y=e[c],A=await V({y,seriesIndex:c,category:n}),w=F(a,y),g={...A,id:y,name:w,x:n},p=s.series.find(u=>y===u.y);p!==void 0&&(!s.colorMatch&&"fillSymbol"in p&&(g.fillSymbol=p.fillSymbol,t=!0),g.id=p.id,g.name=p.name),l.push(g)}return s.series.length===1&&l.length===1&&!s.colorMatch&&"fillSymbol"in s.series[0]&&(l[0].fillSymbol=s.series[0].fillSymbol,t=!0),s.colorMatch=!t,l}var pe=i=>i?.query?.where?.split("=")[1].trim().replace(/'/gu,"")??"",Ae=i=>i.series.some(e=>e.type===m.LineSeries)&&i.series.some(e=>e.type===m.BoxPlotSeries);async function Me(i,e){let s=[];return i.forEach(o=>{if(o.type===m.BoxPlotSeries){let{type:r,fillSymbol:a,...l}=o;s.push({...l,type:m.LineSeries,lineSymbol:{...J({width:W}),...a!==void 0?{color:a.color}:{}},markerSymbol:{...j(),...a!==void 0?{color:a.color}:{}}})}}),s.unshift(await fe({x:i[0].x,y:i[0].y,seriesTemplate:e})),s}function Oe(i){let e=i.slice(1),s=[];return e.forEach(o=>{if(o.type===m.LineSeries){let{type:r,lineSymbol:a,markerSymbol:l,...n}=o,t=T();s.push({...n,type:m.BoxPlotSeries,fillSymbol:{...t,color:a?.color}})}}),s}function be(i){let{formerSeries:e,newSeries:s,showMean:o}=i,r=s,a=t=>t.type===(o?m.LineSeries:m.BoxPlotSeries),l=e.filter(a).map(t=>t.id),n=s.filter(a).map(t=>t.id);return l.length===n.length&&JSON.stringify(l)!==JSON.stringify(n)&&(r=r.sort((t,c)=>l.findIndex(y=>y===t.id)-l.findIndex(y=>y===c.id))),r}async function Ce(i){let{config:e,layerInfo:s,splitByField:o,numericFields:r,category:a}=i,{layer:l,layerFieldsInfo:n}=s,{fetchNullValues:t}=O(e)?.query??{},c=a??B(e),{categoriesArray:y,splitByFieldType:A}=await de({config:e,layer:l,layerFieldsInfo:n,xAxisField:c!==S?c:void 0,aggregationFields:r,splitByField:o,fetchNullValues:t}),w=[],g=!1,p=Ae(e);if(y.length===0){w=await ue({numericFields:r,category:c,config:e,layerInfo:s});for(let u of w)u.query&&(u.query.where=`${o}=''`)}else for(let u=0;u<y.length;u+=1){let v=y[u],L={y:r,seriesIndex:u,category:c},Z=p?await Be(L):await V(L),ge={fieldName:o,fieldValueToMatch:v??"",subtypeInfo:G(s.layer),fieldList:s.layerFieldsInfo},he=H(ge),E=`${v}`,x={...Z,id:E,name:he??E,x:c===void 0||c===""?S:c,query:{...Z.query,where:`${o}=${A===Y.String&&v!==null?`'${v}'`:v}`}},b=e.series.find(we=>pe(we)===E);b!==void 0&&(e.colorMatch||(x.type===m.BoxPlotSeries?C(b)?x.fillSymbol=b.fillSymbol:x.fillSymbol={...T(),color:b.lineSymbol?.color}:C(b)?(x.lineSymbol={...J({width:W}),...b.fillSymbol!==void 0?{color:b.fillSymbol.color}:{}},x.markerSymbol={...j(),...b.fillSymbol!==void 0?{color:b.fillSymbol.color}:{}}):(x.lineSymbol=b.lineSymbol,x.markerSymbol=b.markerSymbol),g=!0),x.id=b.id,x.name=b.name),w.push(x)}if(w=be({formerSeries:e.series,newSeries:w,showMean:K(e)}),e.colorMatch=!g,K(e)){let u=e.series.find(L=>L.type===m.BoxPlotSeries),v=await fe({x:c,y:r,seriesTemplate:u});w.unshift(v)}return w}var U=async i=>{let{splitByField:e,numericFields:s,category:o,config:r,layerInfo:a}=i,l=!(s.length>1&&o!==S)&&e!=="";Le(l?r.showMean:!1,r),r.series=l?await Ce({config:r,layerInfo:a,splitByField:e,numericFields:s,category:o}):await ue({numericFields:s,config:r,layerInfo:a,category:o})},ke=i=>i?.standardizeValues??!1;async function k(i,e){let{layerFieldsInfo:s}=e,o=ke(i),r=await q(),a=o?r.axisLabels.standardizedValues:r.axisLabels.values,l=i?.series?.map(n=>n.y).flat();return l=[...new Set(l)],l.length===1&&(a=F(s,l[0])),a}async function X(i,e){let{layerFieldsInfo:s}=e,o=B(i),r=z(i),a=Q(i),l=r.map(y=>F(s??[],y)).join(", "),n=F(s??[],o),t="",c=await q();return r.length>0&&(o!==S&&a!==""?t=M(c.titleLabels.distributionOfFieldsByCategoryAndSplitBy,{valueFields:l,category:n,splitByField:a}):o!==S?t=M(c.titleLabels.distributionOfFieldsByCategory,{valueFields:l,category:n}):a!==""?t=M(c.titleLabels.distributionOfFieldsByCategory,{valueFields:l,category:a}):t=M(c.titleLabels.distributionOfField,{valueField:l})),t}var Xe=async(i,e,s)=>{let{layerFieldsInfo:o}=s,r=B(e),a=Q(e),l=z(e),n=te(o),t;!n.includes(r)&&n.includes(i)?t=oe():n.includes(r)&&!n.includes(i)&&(t=se()),t!==void 0&&ye(e,t),await U({splitByField:a,numericFields:l,category:i,config:e,layerInfo:s});let c=i!==S?F(o,i):"";I(e,0,c);let y=await k(e,s);I(e,1,y),e?.title!==void 0&&(e.title.content.text=await X(e,s)),P(e,null),D(e,null)},Ze=async(i,e,s)=>{let o=B(e),r=Q(e);await U({splitByField:r,numericFields:i,category:o,config:e,layerInfo:s});let a=await k(e,s);I(e,1,a),e?.title!==void 0&&(e.title.content.text=await X(e,s)),P(e,null),D(e,null)},Ye=i=>{let{series:e,splitByField:s,layerInfo:o,commonStrings:r}=i,a=typeof e.y=="string"?F(o.layerFieldsInfo,e.y):r.axisLabels.values;ee(s)||(a=pe(e));let l={fieldName:s,fieldValueToMatch:a??"",subtypeInfo:G(o.layer),fieldList:o.layerFieldsInfo};return a=H(l)??a,a??e.id},ei=async(i,e,s)=>{let o=B(e),r=z(e);await U({splitByField:i,numericFields:r,category:o,config:e,layerInfo:s});let a=await k(e,s);I(e,1,a),e?.title!==void 0&&(e.title.content.text=await X(e,s)),P(e,null),D(e,null)},ii=i=>i?.showOutliers??!1,si=async(i,e,s)=>{e.showOutliers=i;let o=await k(e,s);I(e,1,o)},oi=async(i,e,s)=>{e.standardizeValues=i;let o=await k(e,s);I(e,1,o)},Se=i=>{let e=d.xAxisAsc,s=i.orderOptions?.data?.orderType??f.Category,o=i.orderOptions?.data?.orderBy??h.Ascending;switch(s){case f.Category:e=Array.isArray(o)?d.customSort:o===h.Ascending?d.xAxisAsc:d.xAxisDesc;break;case f.Mean:e=o===h.Ascending?d.meanAsc:d.meanDesc;break;case f.Median:e=o===h.Ascending?d.medianAsc:d.medianDesc;break}return e},ri=(i,e,s)=>{let o=f.Category,r=h.Ascending;if(e.orderOptions=e.orderOptions??{},i===d.customSort&&s!==void 0)e.orderOptions.data={orderType:f.Category,orderBy:s};else{switch(i){case d.xAxisAsc:{o=f.Category,r=h.Ascending;break}case d.xAxisDesc:{o=f.Category,r=h.Descending;break}case d.meanAsc:{o=f.Mean,r=h.Ascending;break}case d.meanDesc:{o=f.Mean,r=h.Descending;break}case d.medianAsc:{o=f.Median,r=h.Ascending;break}case d.medianDesc:{o=f.Median,r=h.Descending;break}}e.orderOptions.data={orderType:o,orderBy:r}}},K=i=>i.showMean??!1,Le=async(i=!1,e,s)=>{let o=i?s:xe(e),r=(i??!1)!==(e.showMean??!1);if(e.showMean=i,r){let a;i?a=ne(e.series)?await Me(e.series):e.series:a=Oe(e.series),a&&(a=be({formerSeries:e.series,newSeries:a,showMean:i}),e.series=a)}return i&&s!==void 0&&Fe(s,e),{previousMeanLinesBoxColor:o}},ai=i=>{let e=[],s=i.orderOptions?.data?.orderType;return Se(i)===d.customSort&&s===f.Category&&(e=i.orderOptions?.data?.orderBy),e},li=(i,e)=>{e.orderOptions??={};let s=e.orderOptions?.data?.orderType;Se(e)===d.customSort&&s===f.Category&&(e.orderOptions.data={orderType:f.Category,orderBy:i})},ti=i=>i.dataFilters,ni=(i,e)=>{i!==void 0?e.dataFilters=i:delete e.dataFilters},ci=async(i,e)=>{let s=B(i),o=ce(i)?.type,r=z(i),a=[];return o===m.CategoryAxisFormat&&(s===S?a=r:s.trim()!==""&&s!==S&&(a=await me({layerInfo:e,config:i,category:s}))),a};return{a:_e,b:Ge,c:He,d:xe,e:Fe,f:Ke,g:ve,h:Ie,i:Qe,j:Ue,k:B,l:Q,m:z,n:U,o:ke,p:Xe,q:Ze,r:Ye,s:ei,t:ii,u:si,v:oi,w:Se,x:ri,y:K,z:Le,A:ai,B:li,C:ti,D:ni,E:ci}},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,c)
/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import c from"./VQWKI6OJ.js";import{a as w}from"./RTYYUXTS.js";import b from"./NCOEWMF7.js";import{a as g}from"./QDODWAYJ.js";import a from"./PDDPZQ7S.js";import{A as o,E as p,c as d,d as s,n as r,z as m}from"./MDSKC43G.js";import"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{Q:C},{a:v,b:f,c:u},{a:I}])=>{var n={addChartContainer:"add-chart-container",viewChartComponent:"view-chart-component",header:"header",dropdownPopup:"dropdown-popup"},R=d`.view-chart-component{width:var(--arcgis-charts-config-panel-width);height:var(--arcgis-charts-config-panel-height)}.add-chart-container{display:flex;justify-content:center;padding:2rem 0;background-color:var(--calcite-color-background)}.header{margin-left:1rem}.dropdown-popup{position:relative}`,l=class extends m{constructor(){super(...arguments),this._messages=g(),this.chartRenamePopover=null,this.popoverClose=()=>{let e=this.modelList?.find(t=>t.getChartId()===this.selectedChartId);this.chartTitle=e?.getTitleText()??"",this.selectedActionChartId="",this.renameOpen=!1,this.removeChartRenamePopover()},this.onChartRename=e=>{this.disableEditing||(this.chartTitle=e.detail.name,this.modelList?.find(t=>t.getChartId()===this.selectedActionChartId)?.setTitleText(this.chartTitle),this.selectedActionChartId="",this.renameOpen=!1,this.removeChartRenamePopover())},this.onModelConfigChange=()=>{this.requestUpdate()},this.onCalciteListOrderChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{newIndex:t,oldIndex:i}=e.detail;if(this.modelList!==void 0&&this.modelList?.length>0){let a=[...this.modelList],c=a?.[i],h=a?.[t];c&&h&&(a.splice(i,1),a.splice(t,0,c)),this.arcgisChartsConfigModelListReorder.emit({modelList:a})}}},this.chartTitle="",this.noGroup=!1,this.disableEditing=!1,this.arcgisChartsConfigModelListReorder=r(),this.arcgisChartsConfigViewChartAddChart=r(),this.arcgisChartsConfigViewChartDelete=r(),this.arcgisChartsConfigViewChartEdit=r(),this.arcgisChartsConfigViewChartSelect=r()}static{this.properties={chartTitle:16,renameOpen:16,selectedActionChartId:16,messageOverrides:0,selectedChartId:3,layer:0,modelList:2,noGroup:7,disableEditing:7}}static{this.styles=R}willUpdate(e){e.has("modelList")&&this.modelListChange(this.modelList,e.get("modelList"))}disconnectedCallback(){super.disconnectedCallback(),this.removeChartRenamePopover()}modelListChange(e,t){t?.forEach(i=>{i.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}),e?.forEach(i=>{i.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)})}onAddChartClick(e){this.arcgisChartsConfigViewChartAddChart.emit({referenceElement:e.target,layerId:this.layer?.id.toString()})}buildChartList(){let e=this.modelList?w(this.modelList,t=>t.getChartId(),(t,i)=>{let a=t.getChartId(),c=t.getTitleText(),h=I(t.getConfig());return s`<calcite-list-item .label=${c??a??C(this._messages.chartTitle??"",{index:i.toString()})} .selected=${this.selectedChartId===(a?.toString()??i.toString())} .value=${a??i.toString()} @click=${this.onChartSelect}><calcite-icon slot=content-start .icon=${h}></calcite-icon>${this.disableEditing?null:s`<calcite-dropdown slot=actions-end overlay-positioning=fixed placement=bottom-end @calciteDropdownClose=${()=>this.chartActionClosed(a??"")} @calciteDropdownOpen=${()=>this.chartActionOpened(a??"")} class=${o(n.dropdownPopup)}><calcite-action scale=l .text=${this._messages.chartActions??""} slot=trigger .active=${a===this.selectedActionChartId}><calcite-icon icon=ellipsis></calcite-icon></calcite-action><calcite-dropdown-group selection-mode=none><calcite-dropdown-item accesskey=edit @calciteDropdownItemSelect=${this.chartEditSelect}>${this._messages.edit}</calcite-dropdown-item><calcite-dropdown-item accesskey=rename @calciteDropdownItemSelect=${this.chartRenameSelect}>${this._messages.rename}</calcite-dropdown-item><calcite-dropdown-item accesskey=delete @calciteDropdownItemSelect=${this.chartDeleteSelect}>${this._messages.delete}</calcite-dropdown-item></calcite-dropdown-group></calcite-dropdown>`}</calcite-list-item>`}):null;return this.layer?s`<div>${this.noGroup?null:s`<p class=${o(n.header)}>${this.layer.title??this.layer.id.toString()}</p>`}<calcite-list label .dragEnabled=${!this.disableEditing} selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${e}${this.disableEditing?null:s`<div class=${o(n.addChartContainer)}><calcite-fab slot=fab appearance=outline-fill kind=neutral text-enabled .text=${this._messages.addChart} .label=${this._messages.addChart} @click=${this.onAddChartClick} scale=s></calcite-fab></div>`}</calcite-list></div>`:null}onChartSelect(e){let t=e.currentTarget,i;t?.localName==="calcite-list-item"?i=t.value:t?.localName==="calcite-icon"&&(i=t.parentNode.value),this.arcgisChartsConfigViewChartSelect.emit({chartId:i})}chartEditSelect(){this.disableEditing||(this.arcgisChartsConfigViewChartEdit.emit({chartId:this.selectedActionChartId}),this.chartActionClosed(this.selectedActionChartId))}chartRenameSelect(e){if(!this.disableEditing){let t=e.target.closest("calcite-list-item"),i=this.modelList?.find(a=>a.getChartId()===this.selectedActionChartId);t!==null&&(this.renameReferenceElement=t),this.arcgisChartsConfigViewChartSelect.emit({chartId:this.selectedActionChartId}),this.chartTitle=i?.getTitleText()??"",this.renameOpen=!0,this.setupRenamePopover()}}chartDeleteSelect(){this.disableEditing||(this.arcgisChartsConfigViewChartDelete.emit({chartId:this.selectedActionChartId}),this.selectedActionChartId="")}chartActionClosed(e){e===this.selectedActionChartId&&!this.renameOpen&&(this.selectedActionChartId="")}chartActionOpened(e){this.selectedActionChartId=e}setupRenamePopover(){if(this.chartRenamePopover===null){let e={name:this.chartTitle,popoverReferenceElement:this.renameReferenceElement,onChartRename:this.onChartRename,popoverClose:this.popoverClose};this.chartRenamePopover=u(v.ChartRenamePopover,e),document.body.appendChild(this.chartRenamePopover)}this.chartRenamePopover!==null&&(this.chartRenamePopover.open=this.renameOpen,this.chartRenamePopover.name=this.chartTitle,this.chartRenamePopover.popoverReferenceElement=this.renameReferenceElement)}removeChartRenamePopover(){this.chartRenamePopover!==null&&(this.chartRenamePopover.open=!1,this.chartRenamePopover=f(this.chartRenamePopover))}render(){return s`<div class=${o(n.viewChartComponent)}>${this.buildChartList()}</div>`}};p("arcgis-charts-config-view-charts",l);return l},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,c)
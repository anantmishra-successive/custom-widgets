/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import{a as C,b as h}from"./EHA2DPVG.js";import{a as $}from"./RTYYUXTS.js";import{a as b}from"./NEMZXIB4.js";import g from"./NCOEWMF7.js";import e from"./5NI5R3AO.js";import{a as A}from"./QDODWAYJ.js";import{g as s}from"./ITSRCSFZ.js";import a from"./PDDPZQ7S.js";import{A as c,E as F,c as L,d as l,n as f,z as x}from"./MDSKC43G.js";import{a as d}from"./TJWJSZZ6.js";import{b as P}from"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{A:y,Kc:T,Mc:k,Q:w,R:D,b:p,bb:I,tb:S},{a:g,c:u,k:m,o:E,p:N,q:B},{d:O}])=>{var K=L`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:.5rem;padding:.5rem;background:#fff;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:#000}.sort-y-axis{transform:rotate(90deg)}.sort-order-pick-list{overflow-y:hidden}.panel{max-height:60vh}`,n={jsAppFlyout:"js-app-flyout",name:"bar-chart-data-popover",numericFieldPickList:"bar-chart-data-numeric-fields-pick-list",header:"header",fab:"fab",pickListItemLabel:"pick-list-item-label",rotateClass:"sort-y-axis",sortOrderPickList:"sort-order-pick-list",panel:"panel"},v=class extends x{constructor(){super(...arguments),this._messages=A(),this.picklist=C(),this.popoverElement=C(),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.aggregationLabels=[],this.layerFieldsInfo=[],this.isCustomSortDisabled=!1,this.isNoAggregationDisabled=!1,this.arcgisChartsConfigBarChartDataPopoverChange=f(),this.arcgisChartsConfigPopoverClose=f()}static{this.properties={aggregationLabels:16,messageOverrides:0,headingTitle:3,referenceElement:2,open:7,contentKind:1,layerFieldsInfo:0,selectedContent:1,isCustomSortDisabled:5,isNoAggregationDisabled:5}}static{this.styles=K}async reposition(){await this.popoverElement.value?.reposition()}async willUpdate(e){e.has("selectedContent")&&this.selectedContentChange(this.selectedContent,e.get("selectedContent"));let t=await Promise.all(u.map(async i=>await I(i)));y(this.aggregationLabels,t)||(this.aggregationLabels=t)}async updated(){setTimeout(async()=>{await this.picklist.value?.setFocus()},g.PopoverTimer),O(this.popoverElement.value,this.open),this.hasUpdated||setTimeout(()=>{this.popoverElement.value?.reposition()},g.PopoverTimer)}selectedContentChange(e,t){this.pickListHasChanged=!y(e,t)}buildAggregationListItems(){let e=this.isNoAggregationDisabled?u.filter(t=>t!==P.NoAggregation):u;return $(e,t=>t,(t,i)=>l`<calcite-list-item .label=${this.aggregationLabels[i]} .value=${t} .selected=${m(t,this.selectedContent)}></calcite-list-item>`)}createTooltip(e){if(e.target?.label===this._messages.customSort&&this.isCustomSortDisabled){let t=e.target,{formatLocale:i}=D(),a=new Intl.NumberFormat(i).format(g.customSortLimit),o=w(this._messages.customSortLimit??"",{totalLimit:a});this.tooltip=E(t),this.tooltip.innerHTML=o,document.body.appendChild(this.tooltip)}}destroyTooltip(){N(this.tooltip)}buildSortOrder(){let e=Object.keys(d),t;return $(e,i=>i,i=>{let a="";switch(i){case d.xAxisAsc:{t="a-z-down";break}case d.xAxisDesc:{t="a-z-up";break}case d.yAxisAsc:{t="sort-descending",a=n.rotateClass;break}case d.yAxisDesc:{t="sort-ascending",a=n.rotateClass;break}case d.customSort:{t="arrow-up-down";break}}return l`<calcite-list-item .disabled=${this.isCustomSortDisabled&&i===d.customSort} .label=${this._messages[i]} .selected=${this.selectedContent===i} .value=${d[i]} @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}><calcite-icon class=${`sort-icon-color ${a}`} slot=content-start .icon=${t}></calcite-icon></calcite-list-item>`})}buildPickListItem(e){return b(e.name,l`<calcite-list-item .label=${S(this.layerFieldsInfo,e.name)} .value=${e.name} .selected=${m(e.name,this.selectedContent)}></calcite-list-item>`)}buildPickListItems(e){let t=this.layerFieldsInfo?.length??0,i=[];switch(e){case s.numericFields:{for(let a=0;a<t;a+=1){let o=this.layerFieldsInfo?.[a];o&&T(o)&&i.push(this.buildPickListItem(o))}break}case s.category:{let a=b(" ",l`<calcite-list-item label=" " value=" " .selected=${m("",this.selectedContent)}></calcite-list-item>`);i.push(a);for(let o=0;o<t;o+=1){let r=this.layerFieldsInfo?.[o];r&&(k(r)||r.type===p.String||r.type===p.Date||r.type===p.DateOnly||r.type===p.TimestampOffset)&&i.push(this.buildPickListItem(r))}break}case s.splitByField:{let a=b(" ",l`<calcite-list-item label=" " value=" " .selected=${m("",this.selectedContent)}></calcite-list-item>`);i.push(a);for(let o=0;o<t;o+=1){let r=this.layerFieldsInfo?.[o];r&&(k(r)||r.type===p.String)&&i.push(this.buildPickListItem(r))}break}}return i}closePopover(){if(this.contentKind===s.numericFields&&this.pickListHasChanged){let e={pickListElement:this.picklist.value,eventEmitter:this.arcgisChartsConfigBarChartDataPopoverChange,contentKind:this.contentKind};B(e)}this.open=!1,this.arcgisChartsConfigPopoverClose.emit()}onDataContentTypeChange(e){this.pickListHasChanged=!0;let t=e.target.selectedItems;this.arcgisChartsConfigBarChartDataPopoverChange.emit({contentKind:this.contentKind,value:t.map(i=>i.value)}),this.open=!1}onNumericFieldsChange(e){e.target!==null&&(this.selectedContent=e.target.selectedItems.map(t=>t.value))}onNumericFieldSelectionDone(){this.pickListHasChanged&&this.closePopover()}renderAggregationType(){let e=this.buildAggregationListItems();return l`<calcite-list label class=${c(n.pickListItemLabel)} selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderCategory(){let e=this.buildPickListItems(s.category);return l`<calcite-list label class=${c(n.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${h(this.picklist)}>${e}</calcite-list>`}renderNumericFields(){let e=this.buildPickListItems(s.numericFields);return l`<calcite-list label class=${c(n.numericFieldPickList)} selection-mode=multiple filter-enabled @calciteListChange=${this.onNumericFieldsChange} ${h(this.picklist)}>${e}</calcite-list>`}renderSortOrder(){let e=this.buildSortOrder();return l`<calcite-list label class=${c(n.sortOrderPickList)} selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderSplitByField(){let e=this.buildPickListItems(s.splitByField);return l`<calcite-list label class=${c(n.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${h(this.picklist)}>${e}</calcite-list>`}renderPopoverInfo(){let e;switch(this.contentKind){case s.aggregation:e=this.renderAggregationType();break;case s.category:e=this.renderCategory();break;case s.numericFields:e=this.renderNumericFields();break;case s.splitByField:e=this.renderSplitByField();break;case s.sortOrder:e=this.renderSortOrder();break}return e}render(){let e;return this.contentKind===s.numericFields&&(e=l`<div slot=footer><calcite-fab class=${c(n.fab)} appearance=outline-fill kind=neutral icon .label=${this._messages.selectionDone} scale=s text-enabled .text=${this._messages.selectionDone} @click=${this.onNumericFieldSelectionDone}></calcite-fab></div>`),l`<div class=${c(n.jsAppFlyout)}><calcite-popover class=${c(n.name)} .referenceElement=${this.referenceElement??document.body} .placement=${this.placement} .offsetDistance=${this.offsetDistance} .open=${this.open} @calcitePopoverClose=${this.closePopover} label ${h(this.popoverElement)}><calcite-panel class=${c(n.panel)} closable .closed=${!this.open} @calcitePanelClose=${this.closePopover}><div slot=header-content class=${c(n.header)}>${this.headingTitle??""}</div>${this.renderPopoverInfo()}${e}</calcite-panel></calcite-popover></div>`}};F("arcgis-charts-config-bar-chart-popover",v);return v},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,e,g)
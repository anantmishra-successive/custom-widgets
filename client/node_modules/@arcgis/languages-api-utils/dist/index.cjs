"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const p=require("vscode-languageserver-types");async function d(n,r){try{const t=await n,e=new Map,o=new Map,s=[],i=h(r);return t.forEach(c=>{const l=[];c.items.forEach(a=>g(l,o,e,i,a)),l.length&&s.push({...c,items:l})}),{categories:s,functionDefinitions:e,constantDefinitions:o}}catch(t){return console.error(t),{categories:[],functionDefinitions:new Map,constantDefinitions:new Map}}}function h(n){const{profile:{apiVersion:r,bundles:t,hiddenApiItems:e=[]}={}}=n,o=b(r),s=Array.isArray(t)&&t.length>0?new Set(["core",...t]):void 0;return i=>v(o,i.sinceVersion)&&(!s||s.has(i.bundle))&&!e.includes(i.name)}function g(n,r,t,e,o){if(Array.isArray(o)){o.forEach(s=>y(n,t,e,s));return}o.type==="constant"?A(n,r,e,o):y(n,t,e,o)}function y(n,r,t,e){if(!t(e))return;e.disableDocumentation||n.push(e);const{completion:{label:o}}=e,s=o.toLowerCase();let i=r.get(s);i||(i={type:"functionDefinition",key:s,overloads:[]},r.set(s,i)),i.overloads.push(e)}function A(n,r,t,e){if(!t(e))return;n.push(e);const{completion:{label:o}}=e,s=o.toLowerCase();r.set(s,e);const[i,c]=e.completion.label.split(".");if(!c)return;const l=i.toLowerCase();let a=r.get(l);a||(a={type:"namespace",key:l,members:[],completion:{label:i,detail:i,insertText:i,insertTextMode:p.InsertTextMode.adjustIndentation,insertTextFormat:p.InsertTextFormat.PlainText,kind:p.CompletionItemKind.Enum}},r.set(l,a));const u=structuredClone(e);u.name=c,u.completion.label=c,u.completion.insertText=c,u.completion.kind=p.CompletionItemKind.Constant,a.members.push(u),a.completion.documentation=a.members.reduce((f,m)=>(f.value=`${f.value}${f.value?`

`:""}**${m.completion.label}**: ${m.description}`,f),{kind:p.MarkupKind.Markdown,value:""})}function b(n){if(!n||typeof n!="string")return null;const r=n.split(".").map(o=>Number.parseInt(o));if(r.some(Number.isNaN))return console.error("Invalid API version string",n),null;const[t,e]=r.slice(0,2);return{major:t,minor:e}}function v(n,r){if(!n)return!0;const t=b(r);return t?n.major>t.major?!1:n.minor===void 0||t.minor===void 0?!0:t.minor<=n.minor:!0}function w(n){return!!n&&n.type!=="dictionary"}function L(n){return n?.type==="dictionary"}class M{constructor(r){this._settings=r,this.localeToApiLibraryPromiseMap=new Map}async getApiDatabase(r){const{locale:t="en"}=r;let e=this.localeToApiLibraryPromiseMap.get(t);return e||(e=this._settings.getApiLibrary(t),this.localeToApiLibraryPromiseMap.set(t,e)),await d(e,r)}async getApiLibrary(r){const{categories:t}=await this.getApiDatabase(r);return t}}exports.ApiService=M;exports.filterApiLibraryForContext=d;exports.isDictionaryVariable=L;exports.isValueVariable=w;

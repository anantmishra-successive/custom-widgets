/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import{a as L}from"./RTYYUXTS.js";import{a as v}from"./NEMZXIB4.js";import e from"./NCOEWMF7.js";import b from"./5NI5R3AO.js";import{a as C}from"./QDODWAYJ.js";import"./ITSRCSFZ.js";import a from"./PDDPZQ7S.js";import{B as p,E as g,c as d,d as o,n,z as c}from"./MDSKC43G.js";import"./TJWJSZZ6.js";import"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{kb:m},{r:S},{a:f,b:u,c:P}])=>{var N=d`:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}`,l=class extends c{constructor(){super(...arguments),this._messages=C(),this.seriesPopover=null,this.seriesNameChange=e=>{if(e.detail!==null||e.detail!==void 0){let s=e.detail?.name;this.model.setSeriesName(s,this.selectedSeriesIndex??-1)}},this.seriesColorChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{color:s}=e.detail;this.model.setColorMatch(!1),s!==void 0&&(this.model.setSeriesColor(s,this.selectedSeriesIndex??-1),this.model.setSeriesMarkerColor(s,this.selectedSeriesIndex??-1))}},this.seriesLineStyleChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{lineStyle:s}=e.detail;s!==void 0&&this.model.setSeriesLineStyle(s,this.selectedSeriesIndex??-1)}},this.seriesLineWidthChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{lineWidth:s}=e.detail;s!==void 0&&(this.model.setSeriesLineWidth(s,this.selectedSeriesIndex??-1),this.model.setSeriesMarkerSize(s*2,this.selectedSeriesIndex??-1))}},this.seriesPopoverClose=()=>{this.selectedSeriesIndex=void 0,this.configSeriesOpen=!1},this.onModelConfigChange=()=>{this.requestUpdate()},this.openChange=e=>{this.arcgisChartsConfigPopoverOpenChange.emit(e.detail)},this.seriesOrderResetCounter=0,this.configSeriesOpen=!1,this.activeColorMatch=!1,this.popoverPlacement="leading",this.arcgisChartsConfigLineChartSeriesPopoverChange=n(),this.arcgisChartsConfigPopoverOpenChange=n()}static{this.properties={selectedSeriesIndex:16,seriesOrderResetCounter:16,messageOverrides:0,model:0,configSeriesOpen:5,activeColorMatch:5,popoverPlacement:1}}static{this.styles=N}load(){this.modelChange(this.model),this.onModelConfigChange()}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),e.has("selectedSeriesIndex")&&this.selectedSeriesIndexChange()}disconnectedCallback(){super.disconnectedCallback(),this.removeSeriesPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,s){s?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}selectedSeriesIndexChange(){this.selectedSeriesIndex!==void 0&&this.configSeriesOpen?(this.setupSeriesPopover(),this.seriesPopover!==null&&(this.seriesPopover.selectedName=this.model.getSeriesName(this.selectedSeriesIndex),this.seriesPopover.selectedColor=this.model.getSeriesColor(this.selectedSeriesIndex),this.seriesPopover.selectedLineStyle=this.model.getSeriesLineStyle(this.selectedSeriesIndex),this.seriesPopover.selectedLineWidth=this.model.getSeriesLineWidth(this.selectedSeriesIndex),this.seriesPopover.open||(this.seriesPopover.open=!0)),this.addSeriesPopover()):this.removeSeriesPopover()}removeSeriesPopover(){this.seriesPopover!==void 0&&this.seriesPopover!==null&&(this.seriesPopover.open=!1,this.seriesPopover=u(this.seriesPopover)),this.seriesPopoverChange(!1)}buildSeriesListItems(){let e=this.model.getSeriesLength(),s=Array.from({length:e},(i,t)=>t);return L(s,i=>this.model.getSeriesId(i),i=>{let t=this.model.getSeriesId(i),r=this.model.getSeriesColor(i),x=this.model.getSeriesName(i),I=this.model.getChartSubType()===m.BarAndLineFromFields?this._messages.series:t,O=this.model.getSeriesLineStyle(i),b=S(O),a="#CCCCCC",h="minus-circle";if((e>1||!this.activeColorMatch)&&r!==void 0){h=`line-${b}`;let[y,$,M,k]=[...r];a=`rgba(${y},${$},${M},${k/255})`}return o`<calcite-list-item .label=${x??t??""} .description=${I} .value=${t} .selected=${this.selectedSeriesIndex===i} @click=${this.openSeriesPopOver}><calcite-icon slot=content-end .icon=${h} style=${p({color:a})}></calcite-icon></calcite-list-item>`})}buildSeriesList(){return v(this.seriesOrderResetCounter,o`<calcite-list label drag-enabled selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${this.buildSeriesListItems()}</calcite-list>`)}async resetSeriesOriginal(){this.configSeriesOpen=!1,this.selectedSeriesIndex=void 0,this.model.resetSeriesStyling(),this.seriesOrderResetCounter+=1}onCalciteListOrderChange(e){if(e.detail!==null&&e.detail!==void 0){let{newIndex:s,oldIndex:i}=e.detail;this.model.moveSeries(i,s),this.seriesOrderResetCounter+=1}}seriesPopoverChange(e){this.arcgisChartsConfigLineChartSeriesPopoverChange.emit({open:e,element:this.seriesPopover})}openSeriesPopOver(e){let s=e.target,i=s.localName==="calcite-list-item"?s:s.parentNode,t=!this.configSeriesOpen,r=this.model.getSeriesIndex(i.value);this.configSeriesOpen=this.selectedSeriesIndex===r?t:!0,this.configSeriesOpen?this.selectedSeriesIndex=r:this.selectedSeriesIndex=void 0}setupSeriesPopover(){if(this.seriesPopover===null&&this.el!==void 0){let e={referenceElement:this.el,placement:this.popoverPlacement,seriesNameChange:this.seriesNameChange,seriesColorChange:this.seriesColorChange,seriesLineStyleChange:this.seriesLineStyleChange,seriesLineWidthChange:this.seriesLineWidthChange,openChange:this.openChange,popoverClose:this.seriesPopoverClose};this.seriesPopover=P(f.LineChartSeriesPopover,e)}}addSeriesPopover(){this.seriesPopover!=null&&!document.body.contains(this.seriesPopover)&&document.body.appendChild(this.seriesPopover),this.seriesPopoverChange(!0)}render(){return o`<calcite-panel .heading=${this._messages.series}><calcite-button slot=header-actions-end @click=${this.resetSeriesOriginal} .disabled=${!this.model.resetAvailable()} appearance=transparent scale=s icon-end=reset>${this._messages.reset}</calcite-button>${this.buildSeriesList()}</calcite-panel>`}};g("arcgis-charts-config-line-chart-series",l);return l},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,e)
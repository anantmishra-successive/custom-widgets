/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import{a as c,c as V}from"./QJYWZ24Z.js";import{a as h,b as o}from"./EHA2DPVG.js";import f from"./NCOEWMF7.js";import e from"./5NI5R3AO.js";import{a as M}from"./QDODWAYJ.js";import{j as l,l as m}from"./ITSRCSFZ.js";import d from"./PDDPZQ7S.js";import{A as i,B as z,E as T,c as I,d as a,n as b,z as F}from"./MDSKC43G.js";import"./TJWJSZZ6.js";import{a as y}from"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{ca:k,eb:A,h:$,ka:x,t:C,tb:v,w:w,z:L},{b:_,f:f,g:u,h:p,i:g,j:D},{a:R,b:P,c:K}])=>{var s={label:"label",r2:"r2",numberInput:"number-input",iconSelect:"icon-select",sectionLabel:"section-label",switchElement:"switch-element",sectionContainer:"section-container",multiInputSection:"multi-input-section"},N=I`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}:host .number-input{margin-bottom:.5rem;display:flex}:host .number-input>div{width:100%}calcite-list-item{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor)}calcite-slider{margin-top:-1.5rem}.r2{margin:var(--arcgis-charts-config-margin-major) var(--arcgis-charts-config-margin-minor)}.label{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.text{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);width:calc(100% - 1.5rem);height:2rem;margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.section-container{display:flex;flex-direction:column}.icon-select{cursor:pointer}.section-label{display:flex;margin:var(--arcgis-charts-config-margin-major) var(--arcgis-charts-config-margin-minor);justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}.switch-element{margin-right:var(--arcgis-charts-config-margin-minor)}.multi-input-section{display:flex;justify-content:space-between;align-items:center}`,E=class extends F{constructor(){super(...arguments),this._messages=M(),this.scatterplotPopover=null,this.selectColorElement=h(),this.selectTrendLineElement=h(),this.xAxisElement=h(),this.yAxisElement=h(),this.sizeVariableElement=h(),this.colorModeElement=h(),this.symbolSizeModeElement=h(),this.minSizeInputElement=h(),this.maxSizeInputElement=h(),this.items=[],this.setTrendLineSymbol=e=>{let t=e.detail;this.model.setLinearTrendSymbol(w(t))},this.setFixedSymbolRGBAColor=e=>{let t=e.detail,[n,r,d]=t,S=k*255;this.model.setFixedMarkerSymbol({...this.model.getFixedMarkerSymbol(),color:[n,r,d,S]})},this.setXYField=async e=>{try{let t=e.detail;V(c),this.contentKind===l.xAxisField?await this.model.setXAxisField(t):await this.model.setYAxisField(t),this.removeScatterplotPopover()}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}},this.setSizeVariableField=e=>{try{let t=e.detail;t?this.model.setSizePolicy({...this.model.getSizePolicy(),type:y.SizePolicy,field:t}):this.model.setSizePolicy(void 0),c.scatterplotData[c.selectedChartId]={...c.scatterplotData[c.selectedChartId],sizePolicyField:this.model.getSizePolicy()?.field??void 0},this.removeScatterplotPopover()}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}},this.closeScatterplotPopover=e=>{this.scatterplotPopover===e?.target&&(this.contentKind=l.none,this.removeScatterplotPopover())},this.openChange=e=>{this.arcgisChartsConfigPopoverOpenChange.emit(e.detail)},this.onModelConfigChange=()=>{this.requestUpdate();let{minSize:e,maxSize:t}=this.model.getSizePolicy()??{};this.minSizeInputElement.value!==void 0&&e!==void 0&&(this.minSizeInputElement.value.value=`${e}`,f(this.minSizeInputElement.value.value,this.minSizeInputElement.value.min,this.minSizeInputElement.value.max)?p({inputElement:this.minSizeInputElement.value,status:g.IDLE}):p({inputElement:this.minSizeInputElement.value,status:g.INVALID})),this.maxSizeInputElement.value!==void 0&&t!==void 0&&(this.maxSizeInputElement.value.value=`${t}`,f(this.maxSizeInputElement.value.value,this.maxSizeInputElement.value.min,this.maxSizeInputElement.value.max)?p({inputElement:this.maxSizeInputElement.value,status:g.IDLE}):p({inputElement:this.maxSizeInputElement.value,status:g.INVALID}))},this.segmentedControlRef=e=>{e&&(e.focus=()=>{},this.items.push(e))},this.layerFieldsInfo=[],this.arcgisChartsConfigDataChangeError=b(),this.arcgisChartsConfigPopoverOpenChange=b(),this.arcgisChartsConfigScatterplotPopoverChange=b()}static{this.properties={selectedElement:16,selectedSizeType:16,messageOverrides:0,model:0,r2:11,layerFieldsInfo:0,isTableLayer:5,open:7}}static{this.styles=N}async load(){this.modelChange(this.model),this.onModelConfigChange(),this.defaultR2Label=await A(),this.selectedSizeType=this.getCurrentSymbolSizeType(),this.selectedSizeType===m.Proportional&&(c.scatterplotData[c.selectedChartId]={...c.scatterplotData[c.selectedChartId],sizePolicyField:this.model.getSizePolicy()?.field})}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),e.has("selectedElement")&&this.openPopover()}async loaded(){await(async e=>await new Promise(t=>setTimeout(()=>t(),e)))(250),this.items.forEach(e=>{delete e.focus})}disconnectedCallback(){super.disconnectedCallback(),this.removeScatterplotPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}openPopover(){(typeof this.selectedElement=="string"||!L(this.selectedElement))&&this.setupScatterplotPopover()}setShowTrendLine(e){let t=e.target.checked;this.model.setShowLinearTrend(t),!t&&this.contentKind===l.trendLine&&this.closeScatterplotPopover(e)}symbolSizeChange(e){let t=e.target,{value:n}=t;if(n!==void 0&&f(n,t.min,t.max)){let r=Number.parseInt(n),d=this.model.getSizePolicy(),S=this.model.getFixedMarkerSymbol();switch(t.name){case"fixed-symbol-size":S!==void 0&&this.model.setFixedMarkerSymbol({...S,size:r});break;case"proportional-symbol-min-size":d!==void 0&&this.model.setSizePolicy({...d,minSize:r});break;case"proportional-symbol-max-size":d!==void 0&&this.model.setSizePolicy({...d,maxSize:r});break}p({inputElement:t,status:g.IDLE})}else p({inputElement:t,status:g.INVALID})}symbolSizeRangeSliderInput(e){let t=e.target,{minValue:n,maxValue:r}=t,d=this.model.getSizePolicy();d!==void 0&&(this.model.setSizePolicy({...d,minSize:n,maxSize:r}),this.minSizeInputElement.value!==void 0&&(this.minSizeInputElement.value.value=`${n}`),this.maxSizeInputElement.value!==void 0&&(this.maxSizeInputElement.value.value=`${r}`))}changeColorTypeToggle(){let e=this.colorModeElement.value?.selectedItem?.value;this.model.setColorMatch(e===this._messages.useLayerColors)}changeSymbolSizeTypeToggle(){let e=this.symbolSizeModeElement.value?.value;this.selectedSizeType=e;let t=c.scatterplotData[c.selectedChartId]?.sizePolicyField;e===m.Proportional&&t!==void 0?this.model.setSizePolicy({...this.model.getSizePolicy(),type:y.SizePolicy,field:t}):e===m.Fixed&&this.model.setSizePolicy({...this.model.getSizePolicy(),type:y.SizePolicy,field:""})}changeElementStyle(e){let t=e.target;t.localName==="calcite-icon"&&(t=t.parentElement),t.value==="selectColor"?(this.contentKind=l.symbol,this.selectedElement=this.model.getFixedMarkerSymbol()?.color):t.value==="selectTrendLine"&&(this.contentKind=l.trendLine,this.selectedElement=this.model.getLinearTrendSymbol())}onXVariableSelectChange(){this.contentKind=l.xAxisField,this.selectedElement=this.model.getXAxisField()}onYVariableSelectChange(){this.contentKind=l.yAxisField,this.selectedElement=this.model.getYAxisField()}onSizeVariableSelectChange(){this.contentKind=l.sizeVariable,this.selectedElement=this.model.getSizePolicy()?.field??""}setupScatterplotPopover(){this.scatterplotPopover=P(this.scatterplotPopover);let e={setTrendLineSymbol:this.setTrendLineSymbol,setFixedSymbolRGBAColor:this.setFixedSymbolRGBAColor,setXYField:this.setXYField,setSizeVariableField:this.setSizeVariableField,openChange:this.openChange,popoverClose:this.closeScatterplotPopover};switch(this.scatterplotPopover=K(R.ScatterplotDataPopover,e),this.scatterplotPopover.layerFieldsInfo=[...this.layerFieldsInfo],this.scatterplotPopover.contentKind=this.contentKind,this.contentKind){case l.xAxisField:this.scatterplotPopover.referenceElement=this.xAxisElement.value,this.scatterplotPopover.placement="trailing",this.scatterplotPopover.selectedContent=this.model.getXAxisField(),this.scatterplotPopover.headingTitle=this._messages.selectAField;break;case l.yAxisField:this.scatterplotPopover.referenceElement=this.yAxisElement.value,this.scatterplotPopover.placement="trailing",this.scatterplotPopover.selectedContent=this.model.getYAxisField(),this.scatterplotPopover.headingTitle=this._messages.selectAField;break;case l.sizeVariable:this.scatterplotPopover.referenceElement=this.sizeVariableElement.value,this.scatterplotPopover.placement="trailing",this.scatterplotPopover.selectedContent=this.model.getSizePolicy()?.field??"",this.scatterplotPopover.headingTitle=this._messages.selectAField;break;case l.symbol:case l.trendLine:{let t=this.selectedElement;this.scatterplotPopover.selectedContent=this.selectedElement,this.scatterplotPopover.placement="leading",Array.isArray(this.selectedElement)?this.scatterplotPopover.referenceElement=this.selectColorElement.value:t?.type===$.SLS&&(this.scatterplotPopover.referenceElement=this.selectTrendLineElement.value);break}default:this.contentKind=l.none,this.removeScatterplotPopover();break}this.contentKind!==l.none&&(this.scatterplotPopover.open=!0,this.addScatterplotPopover())}removeScatterplotPopover(){this.scatterplotPopover!==null&&(this.scatterplotPopover=P(this.scatterplotPopover)),this.selectedElement={}}addScatterplotPopover(){!document.body.contains(this.scatterplotPopover)&&this.scatterplotPopover!==void 0&&this.scatterplotPopover!==null&&document.body.appendChild(this.scatterplotPopover)}getCurrentSymbolSizeType(){let e=this.model.getSizePolicy();return e===void 0||e.field===""?m.Fixed:m.Proportional}renderXVariable(){return a`<arcgis-charts-config-field-select .label=${v(this.layerFieldsInfo,this.model.getXAxisField()??"")} @click=${this.onXVariableSelectChange} ${o(this.xAxisElement)}></arcgis-charts-config-field-select>`}renderYVariable(){return a`<arcgis-charts-config-field-select .label=${v(this.layerFieldsInfo,this.model.getYAxisField()??"")} @click=${this.onYVariableSelectChange} ${o(this.yAxisElement)}></arcgis-charts-config-field-select>`}renderStatistics(){let[e,t,n,r]=[...this.model.getLinearTrendSymbol()?.color??x(0)];return a`<div class=${i(s.sectionContainer)}><calcite-label class=${i(s.label)} layout=inline-space-between>${this._messages.showLinearTrend}<calcite-switch class=${i(s.switchElement)} .checked=${this.model.getShowLinearTrend()} @calciteSwitchChange=${this.setShowTrendLine}></calcite-switch></calcite-label><calcite-list label selection-mode=single selection-appearance=border><calcite-list-item .label=${this._messages.trendLineStyle} value=selectTrendLine .hidden=${!this.model.getShowLinearTrend()} .selected=${this.selectedElement?.type===$.SLS} @click=${this.changeElementStyle} ${o(this.selectTrendLineElement)}><calcite-icon slot=content-end icon=line-solid style=${z({color:`rgba(${e},${t},${n},${r/255})`})} class=${i(s.iconSelect)} @click=${this.changeElementStyle}></calcite-icon></calcite-list-item></calcite-list><div class=${i(s.r2)} .hidden=${!this.model.getShowLinearTrend()}>${`${this._messages.r2}: ${Number.isNaN(this.r2)?this.defaultR2Label:D(this.r2,_)}`}</div></div>`}renderFixedSymbol(){return a`<calcite-label class=${i(s.label)}>${this._messages.size}<calcite-input type=number name=fixed-symbol-size class=${i(s.numberInput)} min=1 max=100 step=1 .value=${u(this.model.getFixedMarkerSymbol()?.size)} @calciteInputInput=${this.symbolSizeChange}></calcite-input></calcite-label>`}renderSizeVariable(){return a`<arcgis-charts-config-field-select .label=${v(this.layerFieldsInfo,this.model.getSizePolicy()?.field??"")} .invalid=${this.layerFieldsInfo.find(e=>e.name===this.model.getSizePolicy()?.field)===void 0} @click=${this.onSizeVariableSelectChange} ${o(this.sizeVariableElement)}></arcgis-charts-config-field-select>`}renderMinSizeInput(){return a`<calcite-input type=number name=proportional-symbol-min-size class=${i(s.numberInput)} min=1 .max=${this.model.getSizePolicy()?.maxSize??100} step=1 .value=${u(this.model.getSizePolicy()?.minSize)} @calciteInputInput=${this.symbolSizeChange} ${o(this.minSizeInputElement)}></calcite-input>`}renderMaxSizeInput(){return a`<calcite-input type=number name=proportional-symbol-max-size class=${i(s.numberInput)} .min=${this.model.getSizePolicy()?.minSize??1} max=100 step=1 .value=${u(this.model.getSizePolicy()?.maxSize)} @calciteInputInput=${this.symbolSizeChange} ${o(this.maxSizeInputElement)}></calcite-input>`}renderProportionalSymbol(){return a`<div class=${i(s.sectionContainer)}><calcite-label class=${i(s.label)}>${this._messages.numberRequired}${this.renderSizeVariable()}</calcite-label><div class=${i(s.multiInputSection)}><calcite-label class=${i(s.label)}>${this._messages.minSize}${this.renderMinSizeInput()}</calcite-label><calcite-label class=${i(s.label)}>${this._messages.maxSize}${this.renderMaxSizeInput()}</calcite-label></div><calcite-label><calcite-slider min=1 max=100 .minValue=${C(u(this.model.getSizePolicy()?.minSize))} .maxValue=${C(u(this.model.getSizePolicy()?.maxSize))} step=1 @calciteSliderInput=${this.symbolSizeRangeSliderInput}></calcite-slider></calcite-label></div>`}renderSymbolSizeType(){return a`<calcite-label class=${i(s.label)}>${this._messages.size}<calcite-segmented-control name=symbolSizeType layout=horizontal scale=s @calciteSegmentedControlChange=${this.changeSymbolSizeTypeToggle} ${o(this.symbolSizeModeElement)}><calcite-segmented-control-item .value=${m.Fixed} .checked=${m.Fixed===this.selectedSizeType} ${o(this.segmentedControlRef)}>${this._messages.fixed}</calcite-segmented-control-item><calcite-segmented-control-item .value=${m.Proportional} .checked=${m.Proportional===this.selectedSizeType} ${o(this.segmentedControlRef)}>${this._messages.proportional}</calcite-segmented-control-item></calcite-segmented-control></calcite-label>`}renderSymbol(){let[e,t,n,r]=[...this.model.getFixedMarkerSymbol()?.color??x(0)];return a`<div class=${i(s.sectionContainer)}>${this.renderSymbolSizeType()}${this.selectedSizeType===m.Proportional?this.renderProportionalSymbol():this.renderFixedSymbol()}<calcite-label class=${i(s.label)}>${this._messages.color}${this.isTableLayer!==!0?a`<calcite-segmented-control name=layerColor layout=horizontal scale=s @calciteSegmentedControlChange=${this.changeColorTypeToggle} ${o(this.colorModeElement)}><calcite-segmented-control-item .value=${this._messages.useLayerColors} .checked=${this.model.getColorMatch()} ${o(this.segmentedControlRef)}>${this._messages.useLayerColors}</calcite-segmented-control-item><calcite-segmented-control-item .value=${this._messages.singleColor} .checked=${!this.model.getColorMatch()} ${o(this.segmentedControlRef)}>${this._messages.singleColor}</calcite-segmented-control-item></calcite-segmented-control>`:null}</calcite-label><calcite-list label selection-mode=single selection-appearance=border><calcite-list-item .label=${this._messages.color} value=selectColor .hidden=${this.model.getColorMatch()&&this.isTableLayer!==!0} .selected=${Array.isArray(this.selectedElement)} @click=${this.changeElementStyle} ${o(this.selectColorElement)}><calcite-icon slot=content-end icon=circle-f style=${z({color:`rgba(${e},${t},${n},${r/255})`})} class=${i(s.iconSelect)} @click=${this.changeElementStyle}></calcite-icon></calcite-list-item></calcite-list></div>`}render(){return a`<div><h3 class=${i(s.sectionLabel)}>${this._messages.variables}</h3><calcite-label class=${i(s.label)}>${this._messages.xAxisNumber}${this.renderXVariable()}</calcite-label><calcite-label class=${i(s.label)}>${this._messages.yAxisNumber}${this.renderYVariable()}</calcite-label><h3 class=${i(s.sectionLabel)}>${this._messages.statistics}</h3>${this.renderStatistics()}<h3 class=${i(s.sectionLabel)}>${this._messages.symbol}</h3>${this.renderSymbol()}</div>`}};T("arcgis-charts-config-scatter-plot-data",E);return E},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",d,e,f)
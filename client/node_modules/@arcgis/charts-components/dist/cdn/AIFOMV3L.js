/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import{a as x}from"./RTYYUXTS.js";import{a as k}from"./NEMZXIB4.js";import e from"./NCOEWMF7.js";import b from"./5NI5R3AO.js";import{a as $}from"./QDODWAYJ.js";import"./ITSRCSFZ.js";import a from"./PDDPZQ7S.js";import{A as r,B as S,E as f,c as v,d as n,n as c,z as C}from"./MDSKC43G.js";import"./TJWJSZZ6.js";import{b as d,f as t}from"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{C:u,kb:b},{o:P,p:y},{a:O,b:h,c:I}])=>{var A={stackedType:"stacked-type"},o={topSection:"top-section",sectionLabel:"section-label",list:"list",disabledInfo:"disabled-info",disabledStackingOption:"disabled-stacking-option"},E=v`:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}.top-section{margin-top:var(--arcgis-charts-config-margin-minor)}.section-label{display:flex;margin-bottom:var(--arcgis-charts-config-margin-major);margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}.list{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-major)}.disabled-info{margin:auto 1rem;pointer-events:auto}.disabled-info:active{margin:auto 1rem;pointer-events:none}.disabled-stacking-option{pointer-events:none;opacity:var(--calcite-opacity-disabled)}`,g=class extends C{constructor(){super(...arguments),this._messages=$(),this.seriesNameChange=e=>{if(e.detail!==null||e.detail!==void 0){let i=e.detail?.name;this.model.setSeriesName(i,this.selectedSeriesIndex??-1)}},this.seriesColorChange=e=>{if(e.detail!==null&&e.detail!==void 0){let{color:i}=e.detail;this.model.setColorMatch(!1),i!==void 0&&this.model.setSeriesColor(i,this.selectedSeriesIndex??-1)}},this.seriesPopoverClose=()=>{this.selectedSeriesIndex=void 0,this.configSeriesOpen=!1,this.seriesPopover=h(this.seriesPopover)},this.onModelConfigChange=()=>{this.requestUpdate()},this.openChange=e=>{this.arcgisChartsConfigPopoverOpenChange.emit(e.detail)},this.seriesOrderResetCounter=0,this.configSeriesOpen=!1,this.activeColorMatch=!1,this.popoverPlacement="leading",this.arcgisChartsConfigBarChartSeriesPopoverChange=c(),this.arcgisChartsConfigDataChangeError=c(),this.arcgisChartsConfigPopoverOpenChange=c()}static{this.properties={selectedSeriesIndex:16,seriesOrderResetCounter:16,messageOverrides:0,model:0,configSeriesOpen:5,activeColorMatch:5,popoverPlacement:1}}static{this.styles=E}load(){this.modelChange(this.model),this.onModelConfigChange()}willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),e.has("selectedSeriesIndex")&&this.selectedSeriesIndexChange()}disconnectedCallback(){super.disconnectedCallback(),this.removeSeriesPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,i){i?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}selectedSeriesIndexChange(){this.selectedSeriesIndex!==void 0&&this.configSeriesOpen?(this.setupSeriesPopover(),this.seriesPopover&&(this.seriesPopover.selectedName=this.model.getSeriesName(this.selectedSeriesIndex),this.seriesPopover.selectedColor=this.model.getSeriesColor(this.selectedSeriesIndex),this.seriesPopover.open||(this.seriesPopover.open=!0)),this.addSeriesPopover()):this.removeSeriesPopover()}removeSeriesPopover(){this.seriesPopover!==null&&this.seriesPopover!==void 0&&(this.seriesPopover.open=!1,this.seriesPopover=h(this.seriesPopover)),this.seriesPopoverChange(!1)}buildSeriesListItems(){let e=this.model.getSeriesLength()??0,i=Array.from({length:e},(s,a)=>a);return x(i,s=>this.model.getSeriesId(s),s=>{let a=this.model.getSeriesId(s),l=this.model.getSeriesColor(s),T=this.model.getSeriesName(s),L=this.model.getChartSubType()===b.BarAndLineFromFields?this._messages.series:a,p="#CCCCCC",m="minus-square";if((e>1||!this.activeColorMatch)&&l!==void 0){m="square-f";let[M,N,B,_]=[...l];p=`rgba(${M},${N},${B},${_/255})`}return n`<calcite-list-item .label=${T??a??""} .description=${L} .value=${a} .selected=${this.selectedSeriesIndex===s} @click=${this.openSeriesPopOver}><calcite-icon .icon=${m} style=${S({color:p})} slot=content-end></calcite-icon></calcite-list-item>`})}buildSeriesList(){return k(this.seriesOrderResetCounter,n`<calcite-list label class=${r(o.list)} drag-enabled selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${this.buildSeriesListItems()}</calcite-list>`)}buildMultipleBarTypeList(){let e=this.shouldDisableStacking();return e&&this.model.getStackedType()!==t.Side&&this.model.setStackedType(t.Side),n`<calcite-list label id=${A.stackedType} class=${r(o.list)} selection-mode=single-persist selection-appearance=border @click=${this.onMultipleBarSelect}><calcite-list-item .label=${this._messages.sideBySide} .value=${t.Side} .selected=${this.model.getStackedType()===void 0||this.model.getStackedType()===t.Side}><calcite-icon scale=l icon=graph-bar-side-by-side slot=content-start></calcite-icon></calcite-list-item><calcite-list-item class=${r(e?o.disabledStackingOption:"")} .label=${this._messages.stacked} .value=${t.Stacked} .selected=${this.model.getStackedType()===t.Stacked}><calcite-icon scale=l icon=graph-bar-stacked slot=content-start></calcite-icon>${e&&n`<calcite-icon class=${r(o.disabledInfo)} slot=content-end icon=information scale=s flip-rtl @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}></calcite-icon>`||""}</calcite-list-item><calcite-list-item class=${r(e?o.disabledStackingOption:"")} .label=${this._messages.stacked100} .value=${t.Stacked100} .selected=${this.model.getStackedType()===t.Stacked100}><calcite-icon scale=l icon=graph-bar-100-stacked slot=content-start></calcite-icon>${e&&n`<calcite-icon class=${r(o.disabledInfo)} slot=content-end icon=information scale=s flip-rtl @mouseover=${this.createTooltip} @mouseout=${this.destroyTooltip}></calcite-icon>`||""}</calcite-list-item></calcite-list>`}async resetSeriesOriginal(){this.configSeriesOpen=!1,this.selectedSeriesIndex=void 0,this.model.resetSeriesStyling(),this.seriesOrderResetCounter+=1}async onMultipleBarSelect(e){if(!this.shouldDisableStacking()){let i=e.target;await this.model.setStackedType(i.value??i.parentElement.value??"")}}onCalciteListOrderChange(e){if(e.detail!==null&&e.detail!==void 0){let{newIndex:i,oldIndex:s}=e.detail;this.model.moveSeries(s,i),this.seriesOrderResetCounter+=1}}seriesPopoverChange(e){this.arcgisChartsConfigBarChartSeriesPopoverChange.emit({open:e,element:this.seriesPopover})}openSeriesPopOver(e){let i=e.target,s=i.localName==="calcite-list-item"?i:i.parentNode,a=!this.configSeriesOpen,l=this.model.getSeriesIndex(s.value);this.configSeriesOpen=this.selectedSeriesIndex===l?a:!0,this.configSeriesOpen?this.selectedSeriesIndex=l:this.selectedSeriesIndex=void 0}createTooltip(e){let i=e.target,s=this.model.getAggregationType()===d.NoAggregation?this._messages.noAggStackingDisabled:this._messages.singleStackingDisabled;this.tooltip=P(i),this.tooltip.innerHTML=s??"",document.body.appendChild(this.tooltip)}destroyTooltip(){y(this.tooltip)}setupSeriesPopover(){if(u(this.seriesPopover)&&this.el!==void 0){let e={seriesNameChange:this.seriesNameChange,seriesColorChange:this.seriesColorChange,openChange:this.openChange,hostElement:this.el,placement:this.popoverPlacement,popoverClose:this.seriesPopoverClose};this.seriesPopover=I(O.BarChartSeriesPopover,e)}}addSeriesPopover(){this.seriesPopover&&!document.body.contains(this.seriesPopover)&&document.body.appendChild(this.seriesPopover),this.seriesPopoverChange(!0)}shouldDisableStacking(){return(this.model.getSeriesLength()??0)<=1||this.model.getAggregationType()===d.NoAggregation}render(){return n`<div class=${`${o.sectionLabel} ${o.topSection}`}>${this._messages.displayMultiSeries}</div>${this.buildMultipleBarTypeList()}<div class=${r(o.sectionLabel)}>${this._messages.series}<calcite-button @click=${this.resetSeriesOriginal} .disabled=${!this.model.resetAvailable()} appearance=transparent icon-end=reset>${this._messages.reset}</calcite-button></div>${this.buildSeriesList()}`}};f("arcgis-charts-config-bar-chart-series",g);return g},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",a,b,e)
/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import{a as O,c as B}from"./QJYWZ24Z.js";import{a as m,b as h}from"./EHA2DPVG.js";import{a as E}from"./RTYYUXTS.js";import{a as f}from"./NEMZXIB4.js";import e from"./NCOEWMF7.js";import d from"./5NI5R3AO.js";import{a as w}from"./QDODWAYJ.js";import{k as l,m as g}from"./ITSRCSFZ.js";import b from"./PDDPZQ7S.js";import{A as o,E as x,c as v,d as a,f as y,n as S,z as P}from"./MDSKC43G.js";import{b as c}from"./TJWJSZZ6.js";import{a as $}from"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{A:b,ha:d,tb:u,ub:F},{a:I},{a:L,b:p,c:k}])=>{var r={label:"label",fieldList:"field-list",fab:"fab",dimText:"dim-text",list:"list",customSortButtons:"custom-sort-buttons"},N=v`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin);margin-top:var(--arcgis-charts-top-section-margin)}.label,.disabled-label{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.text{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);width:calc(100% - 1.5rem);height:2rem;margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.field-list{max-height:50vh;overflow-y:auto}.disabled-label{pointer-events:none}.fab{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:1.5rem;justify-content:center}.list{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-major)}.custom-sort-buttons{display:flex;justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}`,C=class extends P{constructor(){super(...arguments),this._messages=w(),this.boxPlotPopover=null,this.categoryElement=m(),this.numericFieldsElement=m(),this.splitByFieldElement=m(),this.sortOrderElement=m(),this.originalCustomSortLabels=[],this.isCustomSortDisabled=!1,this.onModelConfigChange=()=>{this.requestUpdate()},this.popoverClose=e=>{this.boxPlotPopover===e?.target&&(this.boxPlotPopover=p(this.boxPlotPopover))},this.onBoxPlotDataChange=async e=>{try{if(e.detail!==null&&e.detail?.value!==void 0){let{contentKind:t}=e.detail,i=[...e.detail.value];switch(B(O),t){case l.category:{let s=i[0]?.trim()||d;if(await this.model.setCategory(s),this.model.getSortOrder()===c.customSort){let n=await this.updateCustomSortProps();this.model.setOrderByList(n),this.sortOrderResetCounter+=1}break}case l.numericFields:{await this.model.setNumericFields(i);let s=i.length>1;if(await this.model.setStandardizeValues(s),this.model.getSortOrder()===c.customSort){let n=await this.updateCustomSortProps();this.model.setOrderByList(n),this.sortOrderResetCounter+=1}break}case l.splitByField:{let s=i[0]?.trim()||"";await this.model.setSplitByField(s);break}case l.sortOrder:{let s=i[0];if(s===c.customSort){let n=await this.updateCustomSortProps();this.model.setSortOrder(s,n)}else this.model.setSortOrder(s);this.sortOrderResetCounter+=1}break;default:break}}}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}this.requestUpdate()},this.selectedCustomSortItemId="",this.sortOrderResetCounter=0,this.layerFieldsInfo=[],this.arcgisChartsConfigDataChangeError=S()}static{this.properties={selectedCustomSortItemId:16,sortOrderResetCounter:16,messageOverrides:0,model:0,layerFieldsInfo:0}}static{this.styles=N}load(){this.modelChange(this.model),this.onModelConfigChange(),this.currentDataFilter=this.model.getDataFilter(),this.updateCustomSortProps()}async willUpdate(e){e.has("model")&&this.modelChange(this.model,e.get("model")),b(this.model.getDataFilter(),this.currentDataFilter)||(await this.updateCustomSortProps(),this.currentDataFilter=this.model.getDataFilter()),this.disableSplitBy=this.model.getNumericFields().length===0||this.model.getNumericFields().length>1&&this.model.getCategory()!==d}disconnectedCallback(){super.disconnectedCallback(),this.boxPlotPopover=p(this.boxPlotPopover),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}modelChange(e,t){t?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),e?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}onCalciteListOrderChange(e){if(e.detail!==null&&e.detail!==void 0){let{newIndex:t,oldIndex:i}=e.detail;this.model.moveCustomSortValuesInOrderByList(i,t)}}onCustomSortItemSelected(e){let{id:t}=e.target;this.selectedCustomSortItemId=this.selectedCustomSortItemId===t?"":t}onCustomSortItemMoved(e){let{id:t}=e.target,i=this.model.getOrderByList().length,s=this.model.getOrderByList().indexOf(this.selectedCustomSortItemId);t===g.Up?i=s-1:t===g.Down&&(i=s+1),s>=0&&i>=0&&i<this.model.getOrderByList().length&&(this.model.moveCustomSortValuesInOrderByList(s,i),this.sortOrderResetCounter+=1)}buildCustomSortListItems(){return E(this.model.getOrderByList(),e=>e,e=>{let t=F(this.layerFieldsInfo,e);return a`<calcite-list-item id=${e??y} .label=${e??""} .description=${t} .value=${e} .selected=${this.selectedCustomSortItemId===e} @calciteListItemSelect=${this.onCustomSortItemSelected}><calcite-icon slot=content-end></calcite-icon></calcite-list-item>`})}buildCustomSortList(){return f(this.sortOrderResetCounter,a`<calcite-list label class=${o(r.list)} drag-enabled selection-mode=single selection-appearance=border @calciteListOrderChange=${this.onCalciteListOrderChange}>${this.buildCustomSortListItems()}</calcite-list>`)}buildNumericFieldItem(e){return f(e,a`<calcite-list-item .label=${u(this.layerFieldsInfo,e)} .value=${e} closable @calciteListItemClose=${this.onRemoveNumericField}></calcite-list-item>`)}onCategorySelect(){this.categoryElement.value&&!this.categoryElement.value.disabled&&(this.contentKind=l.category,this.setupPopover())}async onRemoveNumericField(e){let t=e.target.value;if(await this.model.setNumericFields(this.model.getNumericFields().filter(i=>i!==t)),this.model.getNumericFields().length===0&&this.model.resetConfig(),this.model.getSortOrder()===c.customSort){let i=await this.updateCustomSortProps();this.model.setOrderByList(i),this.sortOrderResetCounter+=1}}async updateCustomSortProps(){let e=await this.model.getCustomSortValues();this.originalCustomSortLabels=[...e];let t=e.length>I.customSortLimit;return t&&(this.sortOrderElement.value&&(this.sortOrderElement.value.label=this._messages.xAxisAsc),this.model.setSortOrder(c.xAxisAsc)),this.isCustomSortDisabled=t,e}async onStandardizeValuesChange(e){await this.model.setStandardizeValues(e.target.checked)}async onShowOutliersChange(e){await this.model.setShowOutliers(e.target.checked)}onSplitBySelect(){this.splitByFieldElement.value&&!this.splitByFieldElement.value.disabled&&(this.contentKind=l.splitByField,this.setupPopover())}onSortOrderSelect(){this.contentKind=l.sortOrder,this.setupPopover()}setupPopover(){this.boxPlotPopover=p(this.boxPlotPopover);let e={layerFieldsInfo:this.layerFieldsInfo,onBoxPlotDataChange:this.onBoxPlotDataChange,popoverClose:this.popoverClose};if(this.boxPlotPopover=k(L.BoxPlotDataPopover,e),this.boxPlotPopover!==null){switch(this.contentKind){case l.category:this.boxPlotPopover.referenceElement=this.categoryElement.value,this.boxPlotPopover.headingTitle=this._messages.categoryHeader,this.boxPlotPopover.selectedContent=this.model.getCategory()===d?"":this.model.getCategory();break;case l.numericFields:this.boxPlotPopover.referenceElement=this.numericFieldsElement.value,this.boxPlotPopover.headingTitle=this._messages.numericFieldsHeader,this.boxPlotPopover.selectedContent=this.model.getNumericFields();break;case l.splitByField:this.boxPlotPopover.referenceElement=this.splitByFieldElement.value,this.boxPlotPopover.headingTitle=this._messages.splitByFieldHeader,this.boxPlotPopover.selectedContent=this.model.getSplitByField();break;case l.sortOrder:this.boxPlotPopover.referenceElement=this.sortOrderElement.value,this.boxPlotPopover.headingTitle=this._messages.selectSortOrder,this.boxPlotPopover.selectedContent=this.model.getSortOrder(),this.boxPlotPopover.isCustomSortDisabled=this.isCustomSortDisabled;break}this.boxPlotPopover.contentKind=this.contentKind,this.boxPlotPopover.open=!0,this.addPopover()}}addPopover(){!document.body.contains(this.boxPlotPopover)&&this.boxPlotPopover!==null&&document.body.appendChild(this.boxPlotPopover)}onAddNumericFields(){this.contentKind=l.numericFields,this.setupPopover()}getCorrectedSplitByValue(){return this.model.getSplitByField()?.trim()===""?"":u(this.layerFieldsInfo,this.model.getSplitByField())}getCorrectedCategoryValue(){return this.model.getCategory()===d?"":u(this.layerFieldsInfo,this.model.getCategory())}resetToOriginalCustomSortLabels(){this.selectedCustomSortItemId="",this.model.setOrderByList([...this.originalCustomSortLabels]),this.sortOrderResetCounter+=1}renderCustomSortUI(){let e=this.model.getSortOrder(),t=this.model.getXAxisValueFormat()?.type,i=this.model.getOrderByList().indexOf(this.selectedCustomSortItemId);return t===$.CategoryAxisFormat&&e===c.customSort&&!this.isCustomSortDisabled?a`<calcite-label class=${o(r.label)}><div class=${o(r.customSortButtons)}><div><calcite-button appearance=transparent .disabled=${i===0||i===-1||this.selectedCustomSortItemId.trim()===""} icon-start=arrow-bold-up id=${g.Up} kind=neutral scale=s @click=${this.onCustomSortItemMoved}></calcite-button><calcite-button appearance=transparent .disabled=${i===-1||i===this.model.getOrderByList().length-1||this.selectedCustomSortItemId.trim()===""} icon-start=arrow-bold-down id=${g.Down} kind=neutral scale=s @click=${this.onCustomSortItemMoved}></calcite-button></div><calcite-button @click=${this.resetToOriginalCustomSortLabels} .disabled=${b(this.model.getOrderByList(),this.originalCustomSortLabels)} appearance=transparent icon-end=reset>${this._messages.reset}</calcite-button></div>${this.model.getCategory()===d?this._messages.values:this._messages.category}${this.buildCustomSortList()}</calcite-label>`:null}renderNumericFields(e){let t=[];for(let i of e)t.push(this.buildNumericFieldItem(i));return a`<calcite-list label class=${o(r.fieldList)} ${h(this.numericFieldsElement)}>${t}</calcite-list>`}renderCategory(){let e=this.getCorrectedCategoryValue(),t=this.model.getNumericFields().length===0||(this.model.getNumericFields()??[]).length>1&&this.model.getSplitByField()!=="";return a`<arcgis-charts-config-field-select .label=${e} .disabled=${t} @click=${this.onCategorySelect} ${h(this.categoryElement)}></arcgis-charts-config-field-select>`}renderSplitBy(){let e=this.getCorrectedSplitByValue();return a`<arcgis-charts-config-field-select .label=${e} .disabled=${this.disableSplitBy} @click=${this.onSplitBySelect} ${h(this.splitByFieldElement)}></arcgis-charts-config-field-select>`}renderSorting(){return a`<arcgis-charts-config-field-select .label=${this._messages[this.model.getSortOrder()]} @click=${this.onSortOrderSelect} ${h(this.sortOrderElement)}></arcgis-charts-config-field-select>`}render(){let e=this.renderCategory(),t=this.renderNumericFields([...this.model.getNumericFields()??[]]),i=this.renderSplitBy(),s=this.renderSorting(),n=this.renderCustomSortUI();return a`<div><calcite-label class=${o(r.label)}>${this._messages.numericFields}${t}</calcite-label><div class=${o(r.fab)}><calcite-fab appearance=outline-fill kind=neutral scale=m .label=${this._messages.selectNumericFields} text-enabled .text=${this._messages.selectNumericFields} icon=plus @click=${this.onAddNumericFields}></calcite-fab></div><calcite-label class=${o(r.label)}><div>${this._messages.category} <span class=${o(r.dimText)}>(${this._messages.optional})</span></div>${e}</calcite-label><calcite-label class=${o(r.label)}><div class=${o(this.disableSplitBy?r.dimText:"")}>${this._messages.splitBy} <span class=${o(r.dimText)}>(${this._messages.optional})</span></div>${i}</calcite-label><div>${(this.model.getNumericFields()??[]).length>1?a`<calcite-label class=${o(r.label)} layout=inline-space-between>${this._messages.standardizeValues}<calcite-switch .checked=${this.model.getStandardizeValues()} @calciteSwitchChange=${this.onStandardizeValuesChange}></calcite-switch></calcite-label>`:null}</div><calcite-label class=${o(r.label)} layout=inline-space-between>${this._messages.showOutliers}<calcite-switch .checked=${this.model.getShowOutliers()} @calciteSwitchChange=${this.onShowOutliersChange}></calcite-switch></calcite-label><calcite-label class=${o(r.label)}>${this._messages.sortOrder}${s}</calcite-label>${n}</div>`}};x("arcgis-charts-config-box-plot-data",C);return C},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",b,d,e)
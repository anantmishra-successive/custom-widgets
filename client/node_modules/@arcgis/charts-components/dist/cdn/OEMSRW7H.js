/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.33/esri/copyright.txt for details.
v4.33.19 */
import{a as d,b as p}from"./EHA2DPVG.js";import{a as k}from"./RTYYUXTS.js";import{a as $}from"./NEMZXIB4.js";import e from"./NCOEWMF7.js";import c from"./5NI5R3AO.js";import{a as D}from"./QDODWAYJ.js";import{f as a}from"./ITSRCSFZ.js";import b from"./PDDPZQ7S.js";import{A as o,E as x,c as F,d as l,n as f,z as I}from"./MDSKC43G.js";import"./TJWJSZZ6.js";import{l as r,p as m}from"./IYCX42AE.js";import"./YG7SBKS5.js";export default $arcgis.t(([,,,,,,,{A:b,Ab:A,Kc:v,Mc:E,b:h,bb:P,cb:w,tb:T},{a:C,c:y,g:z,k:g,q:S},{d:N}])=>{var K=F`.hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0;left:0}.am5-modal-curtain{top:0;left:0;width:100%;height:100%;position:absolute;background:#fff!important;z-index:100}.am5-modal-wrapper{top:0;left:0;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:#ffffff80;z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:start;white-space:normal;background:#fff;border-radius:4px;box-shadow:#00000073 0 0 36px;color:#000}.am5-layer-1000{z-index:1000!important}.arcgis-charts-modal{box-shadow:none!important}.arcgis-charts-modal-header{background-color:#0000000d;font-weight:700;padding:4px;align-content:center}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:.5rem;padding:.5rem;background:#fff;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:#000}.sort-y-axis{transform:rotate(90deg)}calcite-panel{max-height:60vh}calcite-panel .size-section{width:19rem;margin:1rem 0;display:flex;flex-wrap:wrap;justify-content:space-evenly}calcite-panel .size-section calcite-label{width:8rem;margin-bottom:.25rem}calcite-panel .apply-button{width:17rem}`,c={jsAppFlyout:"js-app-flyout",name:"line-chart-data-popover",numericFieldPickList:"line-chart-data-numeric-fields-pick-list",header:"header",fab:"fab",pickListItemLabel:"pick-list-item-label",sizeSection:"size-section",applyButton:"apply-button"},L=class extends I{constructor(){super(...arguments),this._messages=D(),this.picklist=d(),this.intervalSizeElement=d(),this.intervalTypeElement=d(),this.popoverElement=d(),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.layerFieldsInfo=[],this.arcgisChartsConfigLineChartDataPopoverChange=f(),this.arcgisChartsConfigLineChartPopoverClose=f()}static{this.properties={aggregationLabels:16,timeAggregationLabels:16,messageOverrides:0,headingTitle:3,referenceElement:2,open:7,contentKind:1,layerFieldsInfo:0,selectedContent:1}}static{this.styles=K}async reposition(){await this.popoverElement.value?.reposition()}async willUpdate(e){e.has("selectedContent")&&this.selectedContentChange(this.selectedContent,e.get("selectedContent"));let t=await Promise.all(y.map(async i=>await P(i)));b(this.aggregationLabels,t)||(this.aggregationLabels=t);let s=[m.Start,m.End],n=await Promise.all(s.map(async i=>await w(i)));b(this.timeAggregationLabels,n)||(this.timeAggregationLabels=n)}async updated(){setTimeout(async()=>{typeof this.picklist.value?.setFocus=="function"&&await this.picklist.value?.setFocus()},C.PopoverTimer),N(this.popoverElement.value,this.open),this.hasUpdated||setTimeout(()=>{this.popoverElement.value?.reposition()},C.PopoverTimer)}selectedContentChange(e,t){this.pickListHasChanged=!b(e,t)}buildAggregationPickListItems(){return k(y,e=>e,(e,t)=>l`<calcite-list-item .label=${this.aggregationLabels?.[t]} .value=${e} .selected=${g(e,this.selectedContent)}></calcite-list-item>`)}buildIntervalAlignmentPickListItems(){let e=[m.Start,m.End];return k(e,t=>t,(t,s)=>l`<calcite-list-item .label=${this.timeAggregationLabels?.[s]} .value=${t} .selected=${g(t,this.selectedContent)}></calcite-list-item>`)}buildPickListItem(e){return $(e.name,l`<calcite-list-item .label=${T(this.layerFieldsInfo,e.name)} .value=${e.name} .selected=${g(e.name,this.selectedContent)}></calcite-list-item>`)}buildPickListItems(e){let t=this.layerFieldsInfo?.length??0,s=[];switch(e){case a.numericFields:{for(let n=0;n<t;n+=1){let i=this.layerFieldsInfo?.[n];i&&v(i)&&s.push(this.buildPickListItem(i))}break}case a.xAxisField:{for(let n=0;n<t;n+=1){let i=this.layerFieldsInfo?.[n];i&&(v(i)||i.type===h.Date||i.type===h.DateOnly||i.type===h.TimestampOffset)&&s.push(this.buildPickListItem(i))}break}case a.splitByField:{let n=$(" ",l`<calcite-list-item label=" " value=" " .selected=${g("",this.selectedContent)}></calcite-list-item>`);s.push(n);for(let i=0;i<t;i+=1){let u=this.layerFieldsInfo?.[i];u&&(E(u)||u.type===h.String)&&s.push(this.buildPickListItem(u))}break}}return s}closePopover(){if(this.contentKind===a.numericFields){let e={pickListElement:this.picklist.value,eventEmitter:this.arcgisChartsConfigLineChartDataPopoverChange,contentKind:this.contentKind};S(e)}this.open=!1,this.arcgisChartsConfigLineChartPopoverClose.emit()}onDataContentTypeChange(e){this.pickListHasChanged=!0;let t=e.target.selectedItems;this.arcgisChartsConfigLineChartDataPopoverChange.emit({contentKind:this.contentKind,value:t.map(s=>s.value)}),this.open=!1}intervalChange(){let e=Number.parseInt(this.intervalSizeElement.value?.value??""),t=this.intervalTypeElement.value?.selectedOption?.value;!Number.isNaN(e)&&e>0&&this.arcgisChartsConfigLineChartDataPopoverChange.emit({contentKind:this.contentKind,value:[{intervalSize:e,intervalUnits:t}]}),this.open=!1}onNumericFieldsChange(e){e.target!==null&&(this.selectedContent=e.target.selectedItems.map(t=>t.value))}onNumericFieldSelectionDone(){this.pickListHasChanged&&this.closePopover()}renderAggregationType(){let e=this.buildAggregationPickListItems();return l`<calcite-list label class=${o(c.pickListItemLabel)} selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderXAxisField(){let e=this.buildPickListItems(a.xAxisField);return l`<calcite-list label class=${o(c.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${p(this.picklist)}>${e}</calcite-list>`}renderNumericFields(){let e=this.buildPickListItems(a.numericFields);return l`<calcite-list label class=${o(c.numericFieldPickList)} selection-mode=multiple filter-enabled @calciteListChange=${this.onNumericFieldsChange} ${p(this.picklist)}>${e}</calcite-list>`}renderSplitByField(){let e=this.buildPickListItems(a.splitByField);return l`<calcite-list label class=${o(c.pickListItemLabel)} selection-mode=single selection-appearance=border filter-enabled @calciteListChange=${this.onDataContentTypeChange} ${p(this.picklist)}>${e}</calcite-list>`}renderIntervalAlignment(){let e=this.buildIntervalAlignmentPickListItems();return l`<calcite-list label class=${o(c.pickListItemLabel)} selection-mode=single selection-appearance=border @calciteListChange=${this.onDataContentTypeChange}>${e}</calcite-list>`}renderInterval(){let e=this.selectedContent,t=[r.Second,r.Minute,r.Hour,r.Day,r.Week,r.Month,r.Year];return l`<div><div class=${o(c.sizeSection)}><calcite-label scale=m>${this._messages.intervalSize}<calcite-input type=number scale=m min=1 step=any .value=${z(e?.size,1)} ${p(this.intervalSizeElement)}></calcite-input></calcite-label><calcite-label scale=m>${this._messages.intervalType}<calcite-select .label=${this._messages.intervalType??""} ${p(this.intervalTypeElement)}>${t.map(s=>l`<calcite-option .value=${s} .label=${A(s,this._messages)} .selected=${e?.unit===s}></calcite-option>`)}</calcite-select></calcite-label><calcite-button class=${o(c.applyButton)} appearance=outline @click=${this.intervalChange}>${this._messages.apply}</calcite-button></div></div>`}renderPopoverInfo(){let e;switch(this.contentKind){case a.aggregation:e=this.renderAggregationType();break;case a.xAxisField:e=this.renderXAxisField();break;case a.numericFields:e=this.renderNumericFields();break;case a.splitByField:e=this.renderSplitByField();break;case a.intervalAlignment:e=this.renderIntervalAlignment();break;case a.interval:e=this.renderInterval();break}return e}render(){let e;return this.contentKind===a.numericFields&&(e=l`<div slot=footer><calcite-fab class=${o(c.fab)} appearance=outline-fill kind=neutral icon .label=${this._messages.selectionDone} scale=s text-enabled .text=${this._messages.selectionDone} @click=${this.onNumericFieldSelectionDone}></calcite-fab></div>`),l`<div class=${o(c.jsAppFlyout)}><calcite-popover class=${o(c.name)} .referenceElement=${this.referenceElement??document.body} .placement=${this.placement} .offsetDistance=${this.offsetDistance} @calcitePopoverClose=${this.closePopover} .open=${this.open} label ${p(this.popoverElement)}><calcite-panel closable .closed=${!this.open} @calcitePanelClose=${this.closePopover}><div slot=header-content class=${o(c.header)}>${this.headingTitle??""}</div>${this.renderPopoverInfo()}${e}</calcite-panel></calcite-popover></div>`}};x("arcgis-charts-config-line-chart-popover",L);return L},"geometry/support/jsonUtils","rest/support/AttributeBinsQuery","rest/support/Query","rest/support/StatisticDefinition","time/TimeExtent","core/promiseUtils","request",b,c,e)